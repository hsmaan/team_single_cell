
Reading dataset...
Feature selecting GEX...
 UserWarning:/h/angelo/miniconda3/envs/single_cell_env/lib/python3.7/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
Trying to set attribute `._uns` of view, copying.
Feature selecting ATAC...
Trying to set attribute `.var` of view, copying.
New GEX dim: 2500;
New ATAC dim: 7502;
AnnData dataset's shape: (69249, 10002)
Initializing dataset and dataloader...
The order of labels: ['s1d1', 's1d1', 's1d1', 's1d1', 's1d1', ..., 's4d9', 's4d9', 's4d9', 's4d9', 's4d9']
Length: 69249
Categories (13, object): ['s1d1', 's1d2', 's1d3', 's2d1', ..., 's3d10', 's4d1', 's4d8', 's4d9']
The device: cuda;
The model: DeepGexAtacMultiModalAutoencoder(
  (gex_encoder): Sequential(
    (0): Linear(in_features=2500, out_features=1000, bias=True)
    (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=200, bias=True)
    (5): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Linear(in_features=200, out_features=10, bias=True)
    (8): ReLU()
  )
  (atac_encoder): Sequential(
    (0): Linear(in_features=7502, out_features=2000, bias=True)
    (1): BatchNorm1d(2000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=2000, out_features=400, bias=True)
    (5): BatchNorm1d(400, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Linear(in_features=400, out_features=10, bias=True)
    (8): ReLU()
  )
  (gex_decoder): Sequential(
    (0): Linear(in_features=20, out_features=50, bias=True)
    (1): BatchNorm1d(50, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=50, out_features=100, bias=True)
    (5): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Linear(in_features=100, out_features=2500, bias=True)
    (8): ReLU()
  )
  (atac_decoder): Sequential(
    (0): Linear(in_features=20, out_features=100, bias=True)
    (1): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=100, out_features=300, bias=True)
    (5): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Linear(in_features=300, out_features=7502, bias=True)
    (8): Sigmoid()
  )
);
The dataset: <datasets.anndatadataset.AnnDataDataset object at 0x7f831da69250>;
The optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.01
    weight_decay: 0.06111369208160916
);
Epoch 0 recon loss: 5620.4540621129
Epoch 1 recon loss: 4719.4329422397
Epoch 2 recon loss: 3807.0111543116
Epoch 3 recon loss: 3458.7520214844
Epoch 4 recon loss: 3368.3805894461
Epoch 5 recon loss: 3230.6981179043
Epoch 6 recon loss: 3025.3257859541
Epoch 7 recon loss: 2072.6100708862
Epoch 8 recon loss: 1527.3900486653
Epoch 9 recon loss: 1420.5544273379
Epoch 10 recon loss: 1536.259162262
Epoch 11 recon loss: 1090.91113461
Epoch 12 recon loss: 1013.6180992096
Epoch 13 recon loss: 1148.7974413915
Epoch 14 recon loss: 987.5409041928
Epoch 15 recon loss: 929.5756126026
Epoch 16 recon loss: 731.500201946
Epoch 17 recon loss: 915.9065055526
Epoch 18 recon loss: 1051.6269726394
Epoch 19 recon loss: 908.2606143796
Epoch 20 recon loss: 841.0913525109
Epoch 21 recon loss: 840.1308907283
Epoch 22 recon loss: 807.3428019248
Epoch 23 recon loss: 652.702303992
Epoch 24 recon loss: 746.5392167707
Epoch 25 recon loss: 731.6157477401
Epoch 26 recon loss: 547.6510503474
Epoch 27 recon loss: 531.8031666416
Epoch 28 recon loss: 605.6389886363
Epoch 29 recon loss: 577.0215656183
Epoch 30 recon loss: 505.0273895741
Epoch 31 recon loss: 364.7256433546
Epoch 32 recon loss: 399.0689775011
Epoch 33 recon loss: 394.1336839525
Epoch 34 recon loss: 439.0142028183
Epoch 35 recon loss: 299.587364063
Epoch 36 recon loss: 496.4812329591
Epoch 37 recon loss: 533.5799356471
Epoch 38 recon loss: 434.019377968
Epoch 39 recon loss: 323.0368835061
Epoch 40 recon loss: 364.9997028666
Epoch 41 recon loss: 433.0219834996
Epoch 42 recon loss: 517.2412117402
Epoch 43 recon loss: 367.0989346953
Epoch 44 recon loss: 364.6110866944
Epoch 45 recon loss: 340.5788648944
Epoch 46 recon loss: 355.8305754656
Epoch 47 recon loss: 454.294119543
Epoch 48 recon loss: 402.235162616
Epoch 49 recon loss: 301.8063271213
Epoch 50 recon loss: 423.3798153149
Epoch 51 recon loss: 410.0127607665
Epoch 52 recon loss: 336.7402629876
Epoch 53 recon loss: 340.0120138363
Epoch 54 recon loss: 294.9500891596
Epoch 55 recon loss: 376.5858969028
Epoch 56 recon loss: 355.4868778369
Epoch 57 recon loss: 348.296991185
Epoch 58 recon loss: 326.1336340753
Epoch 59 recon loss: 317.3843680849
Latent space type: <class 'numpy.ndarray'>;
GEX encoded shape: torch.Size([69249, 10]);
ATAC encoded shape: torch.Size([69249, 10]);
Latent space shape: (69249, 20);
0.495897485065086
   celltype_ari  celltype_ami  ...  batch_homogeneity  batch_complete
0      0.049229      0.303485  ...           0.766898        0.871601
[1 rows x 8 columns]
 FutureWarning:/h/angelo/miniconda3/envs/single_cell_env/lib/python3.7/site-packages/anndata/_core/anndata.py:1228: The `inplace` parameter in pandas.Categorical.reorder_categories is deprecated and will be removed in a future version. Reordering categories will always return a new Categorical object.
... storing 'feature_types' as categorical
 FutureWarning:/h/angelo/miniconda3/envs/single_cell_env/lib/python3.7/site-packages/anndata/_core/anndata.py:1228: The `inplace` parameter in pandas.Categorical.reorder_categories is deprecated and will be removed in a future version. Reordering categories will always return a new Categorical object.
... storing 'gene_id' as categorical