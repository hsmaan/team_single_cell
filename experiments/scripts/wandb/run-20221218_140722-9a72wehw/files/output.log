
Reading dataset...
Feature selecting GEX...
 UserWarning:/h/angelo/miniconda3/envs/single_cell_env/lib/python3.7/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
Trying to set attribute `._uns` of view, copying.
Feature selecting ATAC...
Trying to set attribute `.var` of view, copying.
New GEX dim: 1000;
New ATAC dim: 2501;
AnnData dataset's shape: (69249, 3501)
Initializing dataset and dataloader...
The order of labels: ['s1d1', 's1d1', 's1d1', 's1d1', 's1d1', ..., 's4d9', 's4d9', 's4d9', 's4d9', 's4d9']
Length: 69249
Categories (13, object): ['s1d1', 's1d2', 's1d3', 's2d1', ..., 's3d10', 's4d1', 's4d8', 's4d9']
The device: cuda;
The model: DeepGexAtacMultiModalAutoencoder(
  (gex_encoder): Sequential(
    (0): Linear(in_features=1000, out_features=1000, bias=True)
    (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=200, bias=True)
    (5): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Linear(in_features=200, out_features=32, bias=True)
    (8): ReLU()
  )
  (atac_encoder): Sequential(
    (0): Linear(in_features=2501, out_features=2000, bias=True)
    (1): BatchNorm1d(2000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=2000, out_features=400, bias=True)
    (5): BatchNorm1d(400, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Linear(in_features=400, out_features=32, bias=True)
    (8): ReLU()
  )
  (gex_decoder): Sequential(
    (0): Linear(in_features=64, out_features=50, bias=True)
    (1): BatchNorm1d(50, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=50, out_features=100, bias=True)
    (5): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Linear(in_features=100, out_features=1000, bias=True)
    (8): ReLU()
  )
  (atac_decoder): Sequential(
    (0): Linear(in_features=64, out_features=100, bias=True)
    (1): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=100, out_features=300, bias=True)
    (5): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Linear(in_features=300, out_features=2501, bias=True)
    (8): Sigmoid()
  )
);
The dataset: <datasets.anndatadataset.AnnDataDataset object at 0x7fa2b61e3550>;
The optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.0959201046715937
);
Epoch 0 recon loss: 8239.6358553631
Epoch 1 recon loss: 8304.2498719574
Epoch 2 recon loss: 8328.9791395865
Epoch 3 recon loss: 8238.7672177475
Epoch 4 recon loss: 8160.3574619245
Epoch 5 recon loss: 8062.3551858606
Epoch 6 recon loss: 8390.7680678223
Epoch 7 recon loss: 7588.2627520506
Epoch 8 recon loss: 8283.8116643518
Epoch 9 recon loss: 8334.1416927668
Epoch 10 recon loss: 8045.5152874916
Epoch 11 recon loss: 8120.6462735755
Epoch 12 recon loss: 8256.9555582124
Epoch 13 recon loss: 7948.3284598126
Epoch 14 recon loss: 8209.2691374814
Epoch 15 recon loss: 8259.5565844439
Epoch 16 recon loss: 8089.931320002
Epoch 17 recon loss: 8156.3904217511
Epoch 18 recon loss: 8298.7743042778
Epoch 19 recon loss: 7922.0556725327
Epoch 20 recon loss: 8153.0435415886
Epoch 21 recon loss: 7829.0362487231
Epoch 22 recon loss: 8131.4084393991
Epoch 23 recon loss: 8132.4260146013
Epoch 24 recon loss: 8067.3982817064
Epoch 25 recon loss: 8024.4586679871
Epoch 26 recon loss: 7587.3811669532
Epoch 27 recon loss: 7828.7436361338
Epoch 28 recon loss: 7620.7223554513
Epoch 29 recon loss: 7859.1070961821
Epoch 30 recon loss: 7892.316914841
Epoch 31 recon loss: 7656.6324504107
Epoch 32 recon loss: 7956.12562172
Epoch 33 recon loss: 7836.6310429488
Epoch 34 recon loss: 7892.4418062481
Epoch 35 recon loss: 7851.9604937429
Epoch 36 recon loss: 7931.9679343297
Epoch 37 recon loss: 7813.4920384288
Epoch 38 recon loss: 8016.7061565651
Epoch 39 recon loss: 7735.7377212996
Epoch 40 recon loss: 7730.7595406507
Epoch 41 recon loss: 7850.4728593853
Epoch 42 recon loss: 7983.3035724872
Epoch 43 recon loss: 7624.3283108636
Epoch 44 recon loss: 7501.7942836767
Epoch 45 recon loss: 7735.9526053624
Epoch 46 recon loss: 7796.1783333301
Epoch 47 recon loss: 7796.3136111652
Epoch 48 recon loss: 7509.6326543923
Epoch 49 recon loss: 7570.4383448467
Epoch 50 recon loss: 7515.86408654
Epoch 51 recon loss: 7719.9246338787
Epoch 52 recon loss: 7647.7136440484
Epoch 53 recon loss: 7706.8721460196
Epoch 54 recon loss: 7388.4877071273
Epoch 55 recon loss: 7466.3751187705
Epoch 56 recon loss: 7701.3970296186
Epoch 57 recon loss: 7618.6560589476
Epoch 58 recon loss: 7648.9370475206
Epoch 59 recon loss: 7414.7176345096
Latent space type: <class 'numpy.ndarray'>;
GEX encoded shape: torch.Size([69249, 32]);
ATAC encoded shape: torch.Size([69249, 32]);
Latent space shape: (69249, 64);
0.5118736760578948
   celltype_ari  celltype_ami  ...  batch_homogeneity  batch_complete
0      0.113132      0.318701  ...           0.817418         0.87119
[1 rows x 8 columns]
 FutureWarning:/h/angelo/miniconda3/envs/single_cell_env/lib/python3.7/site-packages/anndata/_core/anndata.py:1228: The `inplace` parameter in pandas.Categorical.reorder_categories is deprecated and will be removed in a future version. Reordering categories will always return a new Categorical object.
... storing 'feature_types' as categorical
 FutureWarning:/h/angelo/miniconda3/envs/single_cell_env/lib/python3.7/site-packages/anndata/_core/anndata.py:1228: The `inplace` parameter in pandas.Categorical.reorder_categories is deprecated and will be removed in a future version. Reordering categories will always return a new Categorical object.
... storing 'gene_id' as categorical