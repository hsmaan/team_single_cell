
Reading dataset...
Feature selecting GEX...
 UserWarning:/h/angelo/miniconda3/envs/single_cell_env/lib/python3.7/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
Trying to set attribute `._uns` of view, copying.
Feature selecting ATAC...
Trying to set attribute `.var` of view, copying.
New GEX dim: 5000;
New ATAC dim: 5001;
AnnData dataset's shape: (69249, 10001)
Initializing dataset and dataloader...
The order of labels: ['s1d1', 's1d1', 's1d1', 's1d1', 's1d1', ..., 's4d9', 's4d9', 's4d9', 's4d9', 's4d9']
Length: 69249
Categories (13, object): ['s1d1', 's1d2', 's1d3', 's2d1', ..., 's3d10', 's4d1', 's4d8', 's4d9']
The device: cuda;
The model: DeepGexAtacMultiModalAutoencoder(
  (gex_encoder): Sequential(
    (0): Linear(in_features=5000, out_features=1000, bias=True)
    (1): BatchNorm1d(1000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=200, bias=True)
    (5): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Linear(in_features=200, out_features=5, bias=True)
    (8): ReLU()
  )
  (atac_encoder): Sequential(
    (0): Linear(in_features=5001, out_features=2000, bias=True)
    (1): BatchNorm1d(2000, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=2000, out_features=400, bias=True)
    (5): BatchNorm1d(400, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Linear(in_features=400, out_features=5, bias=True)
    (8): ReLU()
  )
  (gex_decoder): Sequential(
    (0): Linear(in_features=10, out_features=50, bias=True)
    (1): BatchNorm1d(50, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=50, out_features=100, bias=True)
    (5): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Linear(in_features=100, out_features=5000, bias=True)
    (8): ReLU()
  )
  (atac_decoder): Sequential(
    (0): Linear(in_features=10, out_features=100, bias=True)
    (1): BatchNorm1d(100, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=100, out_features=300, bias=True)
    (5): BatchNorm1d(300, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): ReLU()
    (7): Linear(in_features=300, out_features=5001, bias=True)
    (8): Sigmoid()
  )
);
The dataset: <datasets.anndatadataset.AnnDataDataset object at 0x7f7c6ce53e50>;
The optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0.06850572817068183
);
Epoch 0 recon loss: 3522.9743067058
Epoch 1 recon loss: 3532.3566516364
Epoch 2 recon loss: 3422.819479379
Epoch 3 recon loss: 3354.9812708968
Epoch 4 recon loss: 3465.4998237941
Epoch 5 recon loss: 3333.4795697293
Epoch 6 recon loss: 3377.6754621771
Epoch 7 recon loss: 3402.544819601
Epoch 8 recon loss: 3454.9189167776
Epoch 9 recon loss: 3254.3801245273
Epoch 10 recon loss: 3389.5125309045
Epoch 11 recon loss: 3392.5116816347
Epoch 12 recon loss: 3326.8652898251
Epoch 13 recon loss: 3410.4814605696
Epoch 14 recon loss: 3411.371694491
Epoch 15 recon loss: 3363.9539906253
Epoch 16 recon loss: 3367.1205204054
Epoch 17 recon loss: 3372.7926345888
Epoch 18 recon loss: 3459.7669553646
Epoch 19 recon loss: 3355.2426445984
Epoch 20 recon loss: 3272.1705993943
Epoch 21 recon loss: 3392.8376741154
Epoch 22 recon loss: 3238.0206696426
Epoch 23 recon loss: 3302.6320314745
Epoch 24 recon loss: 3239.9675825496
Epoch 25 recon loss: 3410.9142980519
Epoch 26 recon loss: 3300.4165598691
Epoch 27 recon loss: 3446.5858889175
Epoch 28 recon loss: 3424.8775089694
Epoch 29 recon loss: 3304.1792504204
Epoch 30 recon loss: 3337.5290224816
Epoch 31 recon loss: 3278.1838694249
Epoch 32 recon loss: 3214.7647632606
Epoch 33 recon loss: 3379.0445541271
Epoch 34 recon loss: 3228.9712323879
Epoch 35 recon loss: 3289.2944483633
Epoch 36 recon loss: 3238.7621364398
Epoch 37 recon loss: 3303.7700619303
Epoch 38 recon loss: 3279.9586677745
Epoch 39 recon loss: 3331.5491428761
Epoch 40 recon loss: 3250.5474900591
Epoch 41 recon loss: 3352.0643829503
Epoch 42 recon loss: 3281.9688155167
Epoch 43 recon loss: 3252.1491574149
Epoch 44 recon loss: 3227.3210860892
